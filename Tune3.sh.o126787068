{'task': 'task_3_tgca', 'split': 'all', 'save_dir': '/g/data/au38/yy3740/results/EVAL_Carolina_eval_run', 'models_dir': '/g/data/au38/yy3740/results/task_3_tgca_clam_sb_k3_lr1e-4/task_3_tgca_clam_sb_s1', 'model_type': 'clam_sb', 'drop_out': 0.25, 'model_size': 'small'}
Filtered dataset size: 152
label column: label
label dictionary: {0: 0, 1: 1}
number of classes: 2
slide-level counts:  
 label
1     13
0    139
Name: count, dtype: int64
Slide-LVL; Number of samples registered in class 0: 139
Slide-LVL; Number of samples registered in class 1: 13
Data directory: /g/data/au38/yy3740/Eval/Carolina_feats/h5_files
Initializing dataset with 152 entries
Filtered initial_len=152
Filtered filtered_len=152
Filtered 0 entries without corresponding .h5 files.
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 152
Loader contains 152 batches
Loader length after enter summary: 152
Loader length: 152
Batch 0: Data shape: torch.Size([50926, 1024]), Label: tensor([1])
Batch 1: Data shape: torch.Size([70040, 1024]), Label: tensor([1])
Batch 2: Data shape: torch.Size([51219, 1024]), Label: tensor([1])
Batch 3: Data shape: torch.Size([64445, 1024]), Label: tensor([1])
Batch 4: Data shape: torch.Size([66965, 1024]), Label: tensor([1])
Batch 5: Data shape: torch.Size([21883, 1024]), Label: tensor([0])
Batch 6: Data shape: torch.Size([22714, 1024]), Label: tensor([0])
Batch 7: Data shape: torch.Size([21417, 1024]), Label: tensor([0])
Batch 8: Data shape: torch.Size([16983, 1024]), Label: tensor([0])
Batch 9: Data shape: torch.Size([16189, 1024]), Label: tensor([0])
Batch 10: Data shape: torch.Size([16573, 1024]), Label: tensor([0])
Batch 11: Data shape: torch.Size([15977, 1024]), Label: tensor([0])
Batch 12: Data shape: torch.Size([6089, 1024]), Label: tensor([0])
Batch 13: Data shape: torch.Size([5821, 1024]), Label: tensor([0])
Batch 14: Data shape: torch.Size([24795, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([29508, 1024]), Label: tensor([0])
Batch 16: Data shape: torch.Size([14375, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([24277, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([40379, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([23867, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([21603, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([821, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([9181, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([7770, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([17171, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([14450, 1024]), Label: tensor([0])
Batch 26: Data shape: torch.Size([14378, 1024]), Label: tensor([0])
Batch 27: Data shape: torch.Size([14193, 1024]), Label: tensor([0])
Batch 28: Data shape: torch.Size([9585, 1024]), Label: tensor([0])
Batch 29: Data shape: torch.Size([11323, 1024]), Label: tensor([0])
Batch 30: Data shape: torch.Size([11257, 1024]), Label: tensor([0])
Batch 31: Data shape: torch.Size([20254, 1024]), Label: tensor([0])
Batch 32: Data shape: torch.Size([18515, 1024]), Label: tensor([0])
Batch 33: Data shape: torch.Size([17311, 1024]), Label: tensor([0])
Batch 34: Data shape: torch.Size([17418, 1024]), Label: tensor([0])
Batch 35: Data shape: torch.Size([10888, 1024]), Label: tensor([0])
Batch 36: Data shape: torch.Size([3805, 1024]), Label: tensor([0])
Batch 37: Data shape: torch.Size([9474, 1024]), Label: tensor([0])
Batch 38: Data shape: torch.Size([13563, 1024]), Label: tensor([0])
Batch 39: Data shape: torch.Size([12679, 1024]), Label: tensor([0])
Batch 40: Data shape: torch.Size([7499, 1024]), Label: tensor([0])
Batch 41: Data shape: torch.Size([7486, 1024]), Label: tensor([0])
Batch 42: Data shape: torch.Size([18208, 1024]), Label: tensor([0])
Batch 43: Data shape: torch.Size([17204, 1024]), Label: tensor([0])
Batch 44: Data shape: torch.Size([18432, 1024]), Label: tensor([0])
Batch 45: Data shape: torch.Size([19578, 1024]), Label: tensor([0])
Batch 46: Data shape: torch.Size([13464, 1024]), Label: tensor([0])
Batch 47: Data shape: torch.Size([22472, 1024]), Label: tensor([0])
Batch 48: Data shape: torch.Size([19192, 1024]), Label: tensor([0])
Batch 49: Data shape: torch.Size([13248, 1024]), Label: tensor([0])
Batch 50: Data shape: torch.Size([13134, 1024]), Label: tensor([0])
Batch 51: Data shape: torch.Size([2995, 1024]), Label: tensor([0])
Batch 52: Data shape: torch.Size([18401, 1024]), Label: tensor([0])
Batch 53: Data shape: torch.Size([12399, 1024]), Label: tensor([0])
Batch 54: Data shape: torch.Size([9643, 1024]), Label: tensor([0])
Batch 55: Data shape: torch.Size([9981, 1024]), Label: tensor([0])
Batch 56: Data shape: torch.Size([16834, 1024]), Label: tensor([0])
Batch 57: Data shape: torch.Size([21320, 1024]), Label: tensor([0])
Batch 58: Data shape: torch.Size([17859, 1024]), Label: tensor([0])
Batch 59: Data shape: torch.Size([17343, 1024]), Label: tensor([0])
Batch 60: Data shape: torch.Size([13022, 1024]), Label: tensor([0])
Batch 61: Data shape: torch.Size([15195, 1024]), Label: tensor([0])
Batch 62: Data shape: torch.Size([15057, 1024]), Label: tensor([0])
Batch 63: Data shape: torch.Size([16120, 1024]), Label: tensor([0])
Batch 64: Data shape: torch.Size([15572, 1024]), Label: tensor([0])
Batch 65: Data shape: torch.Size([15571, 1024]), Label: tensor([0])
Batch 66: Data shape: torch.Size([14599, 1024]), Label: tensor([0])
Batch 67: Data shape: torch.Size([19850, 1024]), Label: tensor([0])
Batch 68: Data shape: torch.Size([12837, 1024]), Label: tensor([0])
Batch 69: Data shape: torch.Size([11918, 1024]), Label: tensor([0])
Batch 70: Data shape: torch.Size([21113, 1024]), Label: tensor([0])
Batch 71: Data shape: torch.Size([18161, 1024]), Label: tensor([0])
Batch 72: Data shape: torch.Size([18998, 1024]), Label: tensor([0])
Batch 73: Data shape: torch.Size([23053, 1024]), Label: tensor([0])
Batch 74: Data shape: torch.Size([22926, 1024]), Label: tensor([0])
Batch 75: Data shape: torch.Size([19439, 1024]), Label: tensor([0])
Batch 76: Data shape: torch.Size([20747, 1024]), Label: tensor([1])
Batch 77: Data shape: torch.Size([11101, 1024]), Label: tensor([1])
Batch 78: Data shape: torch.Size([8969, 1024]), Label: tensor([1])
Batch 79: Data shape: torch.Size([15436, 1024]), Label: tensor([1])
Batch 80: Data shape: torch.Size([11919, 1024]), Label: tensor([1])
Batch 81: Data shape: torch.Size([3952, 1024]), Label: tensor([0])
Batch 82: Data shape: torch.Size([10222, 1024]), Label: tensor([0])
Batch 83: Data shape: torch.Size([6346, 1024]), Label: tensor([0])
Batch 84: Data shape: torch.Size([798, 1024]), Label: tensor([0])
Batch 85: Data shape: torch.Size([7838, 1024]), Label: tensor([0])
Batch 86: Data shape: torch.Size([9795, 1024]), Label: tensor([0])
Batch 87: Data shape: torch.Size([13754, 1024]), Label: tensor([0])
Batch 88: Data shape: torch.Size([11558, 1024]), Label: tensor([0])
Batch 89: Data shape: torch.Size([10687, 1024]), Label: tensor([0])
Batch 90: Data shape: torch.Size([16964, 1024]), Label: tensor([0])
Batch 91: Data shape: torch.Size([12852, 1024]), Label: tensor([0])
Batch 92: Data shape: torch.Size([12456, 1024]), Label: tensor([0])
Batch 93: Data shape: torch.Size([16007, 1024]), Label: tensor([0])
Batch 94: Data shape: torch.Size([18209, 1024]), Label: tensor([0])
Batch 95: Data shape: torch.Size([10669, 1024]), Label: tensor([0])
Batch 96: Data shape: torch.Size([17785, 1024]), Label: tensor([1])
Batch 97: Data shape: torch.Size([17806, 1024]), Label: tensor([1])
Batch 98: Data shape: torch.Size([17190, 1024]), Label: tensor([1])
Batch 99: Data shape: torch.Size([8777, 1024]), Label: tensor([0])
Batch 100: Data shape: torch.Size([11466, 1024]), Label: tensor([0])
Batch 101: Data shape: torch.Size([9971, 1024]), Label: tensor([0])
Batch 102: Data shape: torch.Size([11554, 1024]), Label: tensor([0])
Batch 103: Data shape: torch.Size([22447, 1024]), Label: tensor([0])
Batch 104: Data shape: torch.Size([5794, 1024]), Label: tensor([0])
Batch 105: Data shape: torch.Size([16981, 1024]), Label: tensor([0])
Batch 106: Data shape: torch.Size([22561, 1024]), Label: tensor([0])
Batch 107: Data shape: torch.Size([17245, 1024]), Label: tensor([0])
Batch 108: Data shape: torch.Size([14961, 1024]), Label: tensor([0])
Batch 109: Data shape: torch.Size([17338, 1024]), Label: tensor([0])
Batch 110: Data shape: torch.Size([14926, 1024]), Label: tensor([0])
Batch 111: Data shape: torch.Size([8608, 1024]), Label: tensor([0])
Batch 112: Data shape: torch.Size([19093, 1024]), Label: tensor([0])
Batch 113: Data shape: torch.Size([35591, 1024]), Label: tensor([0])
Batch 114: Data shape: torch.Size([18766, 1024]), Label: tensor([0])
Batch 115: Data shape: torch.Size([13730, 1024]), Label: tensor([0])
Batch 116: Data shape: torch.Size([17306, 1024]), Label: tensor([0])
Batch 117: Data shape: torch.Size([14140, 1024]), Label: tensor([0])
Batch 118: Data shape: torch.Size([16972, 1024]), Label: tensor([0])
Batch 119: Data shape: torch.Size([27589, 1024]), Label: tensor([0])
Batch 120: Data shape: torch.Size([3029, 1024]), Label: tensor([0])
Batch 121: Data shape: torch.Size([6585, 1024]), Label: tensor([0])
Batch 122: Data shape: torch.Size([14989, 1024]), Label: tensor([0])
Batch 123: Data shape: torch.Size([16690, 1024]), Label: tensor([0])
Batch 124: Data shape: torch.Size([11660, 1024]), Label: tensor([0])
Batch 125: Data shape: torch.Size([10600, 1024]), Label: tensor([0])
Batch 126: Data shape: torch.Size([9975, 1024]), Label: tensor([0])
Batch 127: Data shape: torch.Size([19682, 1024]), Label: tensor([0])
Batch 128: Data shape: torch.Size([6798, 1024]), Label: tensor([0])
Batch 129: Data shape: torch.Size([6100, 1024]), Label: tensor([0])
Batch 130: Data shape: torch.Size([20773, 1024]), Label: tensor([0])
Batch 131: Data shape: torch.Size([20949, 1024]), Label: tensor([0])
Batch 132: Data shape: torch.Size([13131, 1024]), Label: tensor([0])
Batch 133: Data shape: torch.Size([21040, 1024]), Label: tensor([0])
Batch 134: Data shape: torch.Size([14378, 1024]), Label: tensor([0])
Batch 135: Data shape: torch.Size([18511, 1024]), Label: tensor([0])
Batch 136: Data shape: torch.Size([19868, 1024]), Label: tensor([0])
Batch 137: Data shape: torch.Size([11248, 1024]), Label: tensor([0])
Batch 138: Data shape: torch.Size([12265, 1024]), Label: tensor([0])
Batch 139: Data shape: torch.Size([26828, 1024]), Label: tensor([0])
Batch 140: Data shape: torch.Size([16137, 1024]), Label: tensor([0])
Batch 141: Data shape: torch.Size([15720, 1024]), Label: tensor([0])
Batch 142: Data shape: torch.Size([19665, 1024]), Label: tensor([0])
Batch 143: Data shape: torch.Size([25433, 1024]), Label: tensor([0])
Batch 144: Data shape: torch.Size([16698, 1024]), Label: tensor([0])
Batch 145: Data shape: torch.Size([15747, 1024]), Label: tensor([0])
Batch 146: Data shape: torch.Size([16191, 1024]), Label: tensor([0])
Batch 147: Data shape: torch.Size([14755, 1024]), Label: tensor([0])
Batch 148: Data shape: torch.Size([10856, 1024]), Label: tensor([0])
Batch 149: Data shape: torch.Size([37868, 1024]), Label: tensor([0])
Batch 150: Data shape: torch.Size([15945, 1024]), Label: tensor([0])
Batch 151: Data shape: torch.Size([24310, 1024]), Label: tensor([0])
test_error:  0.2565789473684211
auc:  0.8123962368566685
f1 score:  0.7949760046210392
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 152
Loader contains 152 batches
Loader length after enter summary: 152
Loader length: 152
Batch 0: Data shape: torch.Size([50926, 1024]), Label: tensor([1])
Batch 1: Data shape: torch.Size([70040, 1024]), Label: tensor([1])
Batch 2: Data shape: torch.Size([51219, 1024]), Label: tensor([1])
Batch 3: Data shape: torch.Size([64445, 1024]), Label: tensor([1])
Batch 4: Data shape: torch.Size([66965, 1024]), Label: tensor([1])
Batch 5: Data shape: torch.Size([21883, 1024]), Label: tensor([0])
Batch 6: Data shape: torch.Size([22714, 1024]), Label: tensor([0])
Batch 7: Data shape: torch.Size([21417, 1024]), Label: tensor([0])
Batch 8: Data shape: torch.Size([16983, 1024]), Label: tensor([0])
Batch 9: Data shape: torch.Size([16189, 1024]), Label: tensor([0])
Batch 10: Data shape: torch.Size([16573, 1024]), Label: tensor([0])
Batch 11: Data shape: torch.Size([15977, 1024]), Label: tensor([0])
Batch 12: Data shape: torch.Size([6089, 1024]), Label: tensor([0])
Batch 13: Data shape: torch.Size([5821, 1024]), Label: tensor([0])
Batch 14: Data shape: torch.Size([24795, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([29508, 1024]), Label: tensor([0])
Batch 16: Data shape: torch.Size([14375, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([24277, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([40379, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([23867, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([21603, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([821, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([9181, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([7770, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([17171, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([14450, 1024]), Label: tensor([0])
Batch 26: Data shape: torch.Size([14378, 1024]), Label: tensor([0])
Batch 27: Data shape: torch.Size([14193, 1024]), Label: tensor([0])
Batch 28: Data shape: torch.Size([9585, 1024]), Label: tensor([0])
Batch 29: Data shape: torch.Size([11323, 1024]), Label: tensor([0])
Batch 30: Data shape: torch.Size([11257, 1024]), Label: tensor([0])
Batch 31: Data shape: torch.Size([20254, 1024]), Label: tensor([0])
Batch 32: Data shape: torch.Size([18515, 1024]), Label: tensor([0])
Batch 33: Data shape: torch.Size([17311, 1024]), Label: tensor([0])
Batch 34: Data shape: torch.Size([17418, 1024]), Label: tensor([0])
Batch 35: Data shape: torch.Size([10888, 1024]), Label: tensor([0])
Batch 36: Data shape: torch.Size([3805, 1024]), Label: tensor([0])
Batch 37: Data shape: torch.Size([9474, 1024]), Label: tensor([0])
Batch 38: Data shape: torch.Size([13563, 1024]), Label: tensor([0])
Batch 39: Data shape: torch.Size([12679, 1024]), Label: tensor([0])
Batch 40: Data shape: torch.Size([7499, 1024]), Label: tensor([0])
Batch 41: Data shape: torch.Size([7486, 1024]), Label: tensor([0])
Batch 42: Data shape: torch.Size([18208, 1024]), Label: tensor([0])
Batch 43: Data shape: torch.Size([17204, 1024]), Label: tensor([0])
Batch 44: Data shape: torch.Size([18432, 1024]), Label: tensor([0])
Batch 45: Data shape: torch.Size([19578, 1024]), Label: tensor([0])
Batch 46: Data shape: torch.Size([13464, 1024]), Label: tensor([0])
Batch 47: Data shape: torch.Size([22472, 1024]), Label: tensor([0])
Batch 48: Data shape: torch.Size([19192, 1024]), Label: tensor([0])
Batch 49: Data shape: torch.Size([13248, 1024]), Label: tensor([0])
Batch 50: Data shape: torch.Size([13134, 1024]), Label: tensor([0])
Batch 51: Data shape: torch.Size([2995, 1024]), Label: tensor([0])
Batch 52: Data shape: torch.Size([18401, 1024]), Label: tensor([0])
Batch 53: Data shape: torch.Size([12399, 1024]), Label: tensor([0])
Batch 54: Data shape: torch.Size([9643, 1024]), Label: tensor([0])
Batch 55: Data shape: torch.Size([9981, 1024]), Label: tensor([0])
Batch 56: Data shape: torch.Size([16834, 1024]), Label: tensor([0])
Batch 57: Data shape: torch.Size([21320, 1024]), Label: tensor([0])
Batch 58: Data shape: torch.Size([17859, 1024]), Label: tensor([0])
Batch 59: Data shape: torch.Size([17343, 1024]), Label: tensor([0])
Batch 60: Data shape: torch.Size([13022, 1024]), Label: tensor([0])
Batch 61: Data shape: torch.Size([15195, 1024]), Label: tensor([0])
Batch 62: Data shape: torch.Size([15057, 1024]), Label: tensor([0])
Batch 63: Data shape: torch.Size([16120, 1024]), Label: tensor([0])
Batch 64: Data shape: torch.Size([15572, 1024]), Label: tensor([0])
Batch 65: Data shape: torch.Size([15571, 1024]), Label: tensor([0])
Batch 66: Data shape: torch.Size([14599, 1024]), Label: tensor([0])
Batch 67: Data shape: torch.Size([19850, 1024]), Label: tensor([0])
Batch 68: Data shape: torch.Size([12837, 1024]), Label: tensor([0])
Batch 69: Data shape: torch.Size([11918, 1024]), Label: tensor([0])
Batch 70: Data shape: torch.Size([21113, 1024]), Label: tensor([0])
Batch 71: Data shape: torch.Size([18161, 1024]), Label: tensor([0])
Batch 72: Data shape: torch.Size([18998, 1024]), Label: tensor([0])
Batch 73: Data shape: torch.Size([23053, 1024]), Label: tensor([0])
Batch 74: Data shape: torch.Size([22926, 1024]), Label: tensor([0])
Batch 75: Data shape: torch.Size([19439, 1024]), Label: tensor([0])
Batch 76: Data shape: torch.Size([20747, 1024]), Label: tensor([1])
Batch 77: Data shape: torch.Size([11101, 1024]), Label: tensor([1])
Batch 78: Data shape: torch.Size([8969, 1024]), Label: tensor([1])
Batch 79: Data shape: torch.Size([15436, 1024]), Label: tensor([1])
Batch 80: Data shape: torch.Size([11919, 1024]), Label: tensor([1])
Batch 81: Data shape: torch.Size([3952, 1024]), Label: tensor([0])
Batch 82: Data shape: torch.Size([10222, 1024]), Label: tensor([0])
Batch 83: Data shape: torch.Size([6346, 1024]), Label: tensor([0])
Batch 84: Data shape: torch.Size([798, 1024]), Label: tensor([0])
Batch 85: Data shape: torch.Size([7838, 1024]), Label: tensor([0])
Batch 86: Data shape: torch.Size([9795, 1024]), Label: tensor([0])
Batch 87: Data shape: torch.Size([13754, 1024]), Label: tensor([0])
Batch 88: Data shape: torch.Size([11558, 1024]), Label: tensor([0])
Batch 89: Data shape: torch.Size([10687, 1024]), Label: tensor([0])
Batch 90: Data shape: torch.Size([16964, 1024]), Label: tensor([0])
Batch 91: Data shape: torch.Size([12852, 1024]), Label: tensor([0])
Batch 92: Data shape: torch.Size([12456, 1024]), Label: tensor([0])
Batch 93: Data shape: torch.Size([16007, 1024]), Label: tensor([0])
Batch 94: Data shape: torch.Size([18209, 1024]), Label: tensor([0])
Batch 95: Data shape: torch.Size([10669, 1024]), Label: tensor([0])
Batch 96: Data shape: torch.Size([17785, 1024]), Label: tensor([1])
Batch 97: Data shape: torch.Size([17806, 1024]), Label: tensor([1])
Batch 98: Data shape: torch.Size([17190, 1024]), Label: tensor([1])
Batch 99: Data shape: torch.Size([8777, 1024]), Label: tensor([0])
Batch 100: Data shape: torch.Size([11466, 1024]), Label: tensor([0])
Batch 101: Data shape: torch.Size([9971, 1024]), Label: tensor([0])
Batch 102: Data shape: torch.Size([11554, 1024]), Label: tensor([0])
Batch 103: Data shape: torch.Size([22447, 1024]), Label: tensor([0])
Batch 104: Data shape: torch.Size([5794, 1024]), Label: tensor([0])
Batch 105: Data shape: torch.Size([16981, 1024]), Label: tensor([0])
Batch 106: Data shape: torch.Size([22561, 1024]), Label: tensor([0])
Batch 107: Data shape: torch.Size([17245, 1024]), Label: tensor([0])
Batch 108: Data shape: torch.Size([14961, 1024]), Label: tensor([0])
Batch 109: Data shape: torch.Size([17338, 1024]), Label: tensor([0])
Batch 110: Data shape: torch.Size([14926, 1024]), Label: tensor([0])
Batch 111: Data shape: torch.Size([8608, 1024]), Label: tensor([0])
Batch 112: Data shape: torch.Size([19093, 1024]), Label: tensor([0])
Batch 113: Data shape: torch.Size([35591, 1024]), Label: tensor([0])
Batch 114: Data shape: torch.Size([18766, 1024]), Label: tensor([0])
Batch 115: Data shape: torch.Size([13730, 1024]), Label: tensor([0])
Batch 116: Data shape: torch.Size([17306, 1024]), Label: tensor([0])
Batch 117: Data shape: torch.Size([14140, 1024]), Label: tensor([0])
Batch 118: Data shape: torch.Size([16972, 1024]), Label: tensor([0])
Batch 119: Data shape: torch.Size([27589, 1024]), Label: tensor([0])
Batch 120: Data shape: torch.Size([3029, 1024]), Label: tensor([0])
Batch 121: Data shape: torch.Size([6585, 1024]), Label: tensor([0])
Batch 122: Data shape: torch.Size([14989, 1024]), Label: tensor([0])
Batch 123: Data shape: torch.Size([16690, 1024]), Label: tensor([0])
Batch 124: Data shape: torch.Size([11660, 1024]), Label: tensor([0])
Batch 125: Data shape: torch.Size([10600, 1024]), Label: tensor([0])
Batch 126: Data shape: torch.Size([9975, 1024]), Label: tensor([0])
Batch 127: Data shape: torch.Size([19682, 1024]), Label: tensor([0])
Batch 128: Data shape: torch.Size([6798, 1024]), Label: tensor([0])
Batch 129: Data shape: torch.Size([6100, 1024]), Label: tensor([0])
Batch 130: Data shape: torch.Size([20773, 1024]), Label: tensor([0])
Batch 131: Data shape: torch.Size([20949, 1024]), Label: tensor([0])
Batch 132: Data shape: torch.Size([13131, 1024]), Label: tensor([0])
Batch 133: Data shape: torch.Size([21040, 1024]), Label: tensor([0])
Batch 134: Data shape: torch.Size([14378, 1024]), Label: tensor([0])
Batch 135: Data shape: torch.Size([18511, 1024]), Label: tensor([0])
Batch 136: Data shape: torch.Size([19868, 1024]), Label: tensor([0])
Batch 137: Data shape: torch.Size([11248, 1024]), Label: tensor([0])
Batch 138: Data shape: torch.Size([12265, 1024]), Label: tensor([0])
Batch 139: Data shape: torch.Size([26828, 1024]), Label: tensor([0])
Batch 140: Data shape: torch.Size([16137, 1024]), Label: tensor([0])
Batch 141: Data shape: torch.Size([15720, 1024]), Label: tensor([0])
Batch 142: Data shape: torch.Size([19665, 1024]), Label: tensor([0])
Batch 143: Data shape: torch.Size([25433, 1024]), Label: tensor([0])
Batch 144: Data shape: torch.Size([16698, 1024]), Label: tensor([0])
Batch 145: Data shape: torch.Size([15747, 1024]), Label: tensor([0])
Batch 146: Data shape: torch.Size([16191, 1024]), Label: tensor([0])
Batch 147: Data shape: torch.Size([14755, 1024]), Label: tensor([0])
Batch 148: Data shape: torch.Size([10856, 1024]), Label: tensor([0])
Batch 149: Data shape: torch.Size([37868, 1024]), Label: tensor([0])
Batch 150: Data shape: torch.Size([15945, 1024]), Label: tensor([0])
Batch 151: Data shape: torch.Size([24310, 1024]), Label: tensor([0])
test_error:  0.08552631578947369
auc:  0.7205312672938572
f1 score:  0.8847416985369998
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 152
Loader contains 152 batches
Loader length after enter summary: 152
Loader length: 152
Batch 0: Data shape: torch.Size([50926, 1024]), Label: tensor([1])
Batch 1: Data shape: torch.Size([70040, 1024]), Label: tensor([1])
Batch 2: Data shape: torch.Size([51219, 1024]), Label: tensor([1])
Batch 3: Data shape: torch.Size([64445, 1024]), Label: tensor([1])
Batch 4: Data shape: torch.Size([66965, 1024]), Label: tensor([1])
Batch 5: Data shape: torch.Size([21883, 1024]), Label: tensor([0])
Batch 6: Data shape: torch.Size([22714, 1024]), Label: tensor([0])
Batch 7: Data shape: torch.Size([21417, 1024]), Label: tensor([0])
Batch 8: Data shape: torch.Size([16983, 1024]), Label: tensor([0])
Batch 9: Data shape: torch.Size([16189, 1024]), Label: tensor([0])
Batch 10: Data shape: torch.Size([16573, 1024]), Label: tensor([0])
Batch 11: Data shape: torch.Size([15977, 1024]), Label: tensor([0])
Batch 12: Data shape: torch.Size([6089, 1024]), Label: tensor([0])
Batch 13: Data shape: torch.Size([5821, 1024]), Label: tensor([0])
Batch 14: Data shape: torch.Size([24795, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([29508, 1024]), Label: tensor([0])
Batch 16: Data shape: torch.Size([14375, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([24277, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([40379, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([23867, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([21603, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([821, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([9181, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([7770, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([17171, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([14450, 1024]), Label: tensor([0])
Batch 26: Data shape: torch.Size([14378, 1024]), Label: tensor([0])
Batch 27: Data shape: torch.Size([14193, 1024]), Label: tensor([0])
Batch 28: Data shape: torch.Size([9585, 1024]), Label: tensor([0])
Batch 29: Data shape: torch.Size([11323, 1024]), Label: tensor([0])
Batch 30: Data shape: torch.Size([11257, 1024]), Label: tensor([0])
Batch 31: Data shape: torch.Size([20254, 1024]), Label: tensor([0])
Batch 32: Data shape: torch.Size([18515, 1024]), Label: tensor([0])
Batch 33: Data shape: torch.Size([17311, 1024]), Label: tensor([0])
Batch 34: Data shape: torch.Size([17418, 1024]), Label: tensor([0])
Batch 35: Data shape: torch.Size([10888, 1024]), Label: tensor([0])
Batch 36: Data shape: torch.Size([3805, 1024]), Label: tensor([0])
Batch 37: Data shape: torch.Size([9474, 1024]), Label: tensor([0])
Batch 38: Data shape: torch.Size([13563, 1024]), Label: tensor([0])
Batch 39: Data shape: torch.Size([12679, 1024]), Label: tensor([0])
Batch 40: Data shape: torch.Size([7499, 1024]), Label: tensor([0])
Batch 41: Data shape: torch.Size([7486, 1024]), Label: tensor([0])
Batch 42: Data shape: torch.Size([18208, 1024]), Label: tensor([0])
Batch 43: Data shape: torch.Size([17204, 1024]), Label: tensor([0])
Batch 44: Data shape: torch.Size([18432, 1024]), Label: tensor([0])
Batch 45: Data shape: torch.Size([19578, 1024]), Label: tensor([0])
Batch 46: Data shape: torch.Size([13464, 1024]), Label: tensor([0])
Batch 47: Data shape: torch.Size([22472, 1024]), Label: tensor([0])
Batch 48: Data shape: torch.Size([19192, 1024]), Label: tensor([0])
Batch 49: Data shape: torch.Size([13248, 1024]), Label: tensor([0])
Batch 50: Data shape: torch.Size([13134, 1024]), Label: tensor([0])
Batch 51: Data shape: torch.Size([2995, 1024]), Label: tensor([0])
Batch 52: Data shape: torch.Size([18401, 1024]), Label: tensor([0])
Batch 53: Data shape: torch.Size([12399, 1024]), Label: tensor([0])
Batch 54: Data shape: torch.Size([9643, 1024]), Label: tensor([0])
Batch 55: Data shape: torch.Size([9981, 1024]), Label: tensor([0])
Batch 56: Data shape: torch.Size([16834, 1024]), Label: tensor([0])
Batch 57: Data shape: torch.Size([21320, 1024]), Label: tensor([0])
Batch 58: Data shape: torch.Size([17859, 1024]), Label: tensor([0])
Batch 59: Data shape: torch.Size([17343, 1024]), Label: tensor([0])
Batch 60: Data shape: torch.Size([13022, 1024]), Label: tensor([0])
Batch 61: Data shape: torch.Size([15195, 1024]), Label: tensor([0])
Batch 62: Data shape: torch.Size([15057, 1024]), Label: tensor([0])
Batch 63: Data shape: torch.Size([16120, 1024]), Label: tensor([0])
Batch 64: Data shape: torch.Size([15572, 1024]), Label: tensor([0])
Batch 65: Data shape: torch.Size([15571, 1024]), Label: tensor([0])
Batch 66: Data shape: torch.Size([14599, 1024]), Label: tensor([0])
Batch 67: Data shape: torch.Size([19850, 1024]), Label: tensor([0])
Batch 68: Data shape: torch.Size([12837, 1024]), Label: tensor([0])
Batch 69: Data shape: torch.Size([11918, 1024]), Label: tensor([0])
Batch 70: Data shape: torch.Size([21113, 1024]), Label: tensor([0])
Batch 71: Data shape: torch.Size([18161, 1024]), Label: tensor([0])
Batch 72: Data shape: torch.Size([18998, 1024]), Label: tensor([0])
Batch 73: Data shape: torch.Size([23053, 1024]), Label: tensor([0])
Batch 74: Data shape: torch.Size([22926, 1024]), Label: tensor([0])
Batch 75: Data shape: torch.Size([19439, 1024]), Label: tensor([0])
Batch 76: Data shape: torch.Size([20747, 1024]), Label: tensor([1])
Batch 77: Data shape: torch.Size([11101, 1024]), Label: tensor([1])
Batch 78: Data shape: torch.Size([8969, 1024]), Label: tensor([1])
Batch 79: Data shape: torch.Size([15436, 1024]), Label: tensor([1])
Batch 80: Data shape: torch.Size([11919, 1024]), Label: tensor([1])
Batch 81: Data shape: torch.Size([3952, 1024]), Label: tensor([0])
Batch 82: Data shape: torch.Size([10222, 1024]), Label: tensor([0])
Batch 83: Data shape: torch.Size([6346, 1024]), Label: tensor([0])
Batch 84: Data shape: torch.Size([798, 1024]), Label: tensor([0])
Batch 85: Data shape: torch.Size([7838, 1024]), Label: tensor([0])
Batch 86: Data shape: torch.Size([9795, 1024]), Label: tensor([0])
Batch 87: Data shape: torch.Size([13754, 1024]), Label: tensor([0])
Batch 88: Data shape: torch.Size([11558, 1024]), Label: tensor([0])
Batch 89: Data shape: torch.Size([10687, 1024]), Label: tensor([0])
Batch 90: Data shape: torch.Size([16964, 1024]), Label: tensor([0])
Batch 91: Data shape: torch.Size([12852, 1024]), Label: tensor([0])
Batch 92: Data shape: torch.Size([12456, 1024]), Label: tensor([0])
Batch 93: Data shape: torch.Size([16007, 1024]), Label: tensor([0])
Batch 94: Data shape: torch.Size([18209, 1024]), Label: tensor([0])
Batch 95: Data shape: torch.Size([10669, 1024]), Label: tensor([0])
Batch 96: Data shape: torch.Size([17785, 1024]), Label: tensor([1])
Batch 97: Data shape: torch.Size([17806, 1024]), Label: tensor([1])
Batch 98: Data shape: torch.Size([17190, 1024]), Label: tensor([1])
Batch 99: Data shape: torch.Size([8777, 1024]), Label: tensor([0])
Batch 100: Data shape: torch.Size([11466, 1024]), Label: tensor([0])
Batch 101: Data shape: torch.Size([9971, 1024]), Label: tensor([0])
Batch 102: Data shape: torch.Size([11554, 1024]), Label: tensor([0])
Batch 103: Data shape: torch.Size([22447, 1024]), Label: tensor([0])
Batch 104: Data shape: torch.Size([5794, 1024]), Label: tensor([0])
Batch 105: Data shape: torch.Size([16981, 1024]), Label: tensor([0])
Batch 106: Data shape: torch.Size([22561, 1024]), Label: tensor([0])
Batch 107: Data shape: torch.Size([17245, 1024]), Label: tensor([0])
Batch 108: Data shape: torch.Size([14961, 1024]), Label: tensor([0])
Batch 109: Data shape: torch.Size([17338, 1024]), Label: tensor([0])
Batch 110: Data shape: torch.Size([14926, 1024]), Label: tensor([0])
Batch 111: Data shape: torch.Size([8608, 1024]), Label: tensor([0])
Batch 112: Data shape: torch.Size([19093, 1024]), Label: tensor([0])
Batch 113: Data shape: torch.Size([35591, 1024]), Label: tensor([0])
Batch 114: Data shape: torch.Size([18766, 1024]), Label: tensor([0])
Batch 115: Data shape: torch.Size([13730, 1024]), Label: tensor([0])
Batch 116: Data shape: torch.Size([17306, 1024]), Label: tensor([0])
Batch 117: Data shape: torch.Size([14140, 1024]), Label: tensor([0])
Batch 118: Data shape: torch.Size([16972, 1024]), Label: tensor([0])
Batch 119: Data shape: torch.Size([27589, 1024]), Label: tensor([0])
Batch 120: Data shape: torch.Size([3029, 1024]), Label: tensor([0])
Batch 121: Data shape: torch.Size([6585, 1024]), Label: tensor([0])
Batch 122: Data shape: torch.Size([14989, 1024]), Label: tensor([0])
Batch 123: Data shape: torch.Size([16690, 1024]), Label: tensor([0])
Batch 124: Data shape: torch.Size([11660, 1024]), Label: tensor([0])
Batch 125: Data shape: torch.Size([10600, 1024]), Label: tensor([0])
Batch 126: Data shape: torch.Size([9975, 1024]), Label: tensor([0])
Batch 127: Data shape: torch.Size([19682, 1024]), Label: tensor([0])
Batch 128: Data shape: torch.Size([6798, 1024]), Label: tensor([0])
Batch 129: Data shape: torch.Size([6100, 1024]), Label: tensor([0])
Batch 130: Data shape: torch.Size([20773, 1024]), Label: tensor([0])
Batch 131: Data shape: torch.Size([20949, 1024]), Label: tensor([0])
Batch 132: Data shape: torch.Size([13131, 1024]), Label: tensor([0])
Batch 133: Data shape: torch.Size([21040, 1024]), Label: tensor([0])
Batch 134: Data shape: torch.Size([14378, 1024]), Label: tensor([0])
Batch 135: Data shape: torch.Size([18511, 1024]), Label: tensor([0])
Batch 136: Data shape: torch.Size([19868, 1024]), Label: tensor([0])
Batch 137: Data shape: torch.Size([11248, 1024]), Label: tensor([0])
Batch 138: Data shape: torch.Size([12265, 1024]), Label: tensor([0])
Batch 139: Data shape: torch.Size([26828, 1024]), Label: tensor([0])
Batch 140: Data shape: torch.Size([16137, 1024]), Label: tensor([0])
Batch 141: Data shape: torch.Size([15720, 1024]), Label: tensor([0])
Batch 142: Data shape: torch.Size([19665, 1024]), Label: tensor([0])
Batch 143: Data shape: torch.Size([25433, 1024]), Label: tensor([0])
Batch 144: Data shape: torch.Size([16698, 1024]), Label: tensor([0])
Batch 145: Data shape: torch.Size([15747, 1024]), Label: tensor([0])
Batch 146: Data shape: torch.Size([16191, 1024]), Label: tensor([0])
Batch 147: Data shape: torch.Size([14755, 1024]), Label: tensor([0])
Batch 148: Data shape: torch.Size([10856, 1024]), Label: tensor([0])
Batch 149: Data shape: torch.Size([37868, 1024]), Label: tensor([0])
Batch 150: Data shape: torch.Size([15945, 1024]), Label: tensor([0])
Batch 151: Data shape: torch.Size([24310, 1024]), Label: tensor([0])
test_error:  0.09868421052631579
auc:  0.8710570005534035
f1 score:  0.8843490304709141
Ensemble Acc: 0.868421052631579, AUC: 0.4748201438848921, F1: 0.0
{'task': 'task_3_tgca', 'split': 'all', 'save_dir': '/g/data/au38/yy3740/results/EVAL_Georgia_eval_run', 'models_dir': '/g/data/au38/yy3740/results/task_3_tgca_clam_sb_k3_lr1e-4/task_3_tgca_clam_sb_s1', 'model_type': 'clam_sb', 'drop_out': 0.25, 'model_size': 'small'}
Filtered dataset size: 78
label column: label
label dictionary: {0: 0, 1: 1}
number of classes: 2
slide-level counts:  
 label
0.0    70
1.0     8
Name: count, dtype: int64
Slide-LVL; Number of samples registered in class 0: 70
Slide-LVL; Number of samples registered in class 1: 8
Data directory: /g/data/au38/yy3740/Eval/Georgia_feats/h5_files
Initializing dataset with 78 entries
Filtered initial_len=78
Filtered filtered_len=78
Filtered 0 entries without corresponding .h5 files.
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 78
Loader contains 78 batches
Loader length after enter summary: 78
Loader length: 78
Batch 0: Data shape: torch.Size([6842, 1024]), Label: tensor([0])
Batch 1: Data shape: torch.Size([13717, 1024]), Label: tensor([0])
Batch 2: Data shape: torch.Size([22957, 1024]), Label: tensor([0])
Batch 3: Data shape: torch.Size([504, 1024]), Label: tensor([0])
Batch 4: Data shape: torch.Size([12414, 1024]), Label: tensor([0])
Batch 5: Data shape: torch.Size([3385, 1024]), Label: tensor([0])
Batch 6: Data shape: torch.Size([3244, 1024]), Label: tensor([0])
Batch 7: Data shape: torch.Size([28475, 1024]), Label: tensor([0])
Batch 8: Data shape: torch.Size([7531, 1024]), Label: tensor([0])
Batch 9: Data shape: torch.Size([683, 1024]), Label: tensor([0])
Batch 10: Data shape: torch.Size([27187, 1024]), Label: tensor([0])
Batch 11: Data shape: torch.Size([13966, 1024]), Label: tensor([0])
Batch 12: Data shape: torch.Size([13660, 1024]), Label: tensor([0])
Batch 13: Data shape: torch.Size([3155, 1024]), Label: tensor([0])
Batch 14: Data shape: torch.Size([4466, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([3556, 1024]), Label: tensor([0])
Batch 16: Data shape: torch.Size([4937, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([11830, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([22981, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([2345, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([7505, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([1748, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([6245, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([19868, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([7603, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([6098, 1024]), Label: tensor([0])
Batch 26: Data shape: torch.Size([14530, 1024]), Label: tensor([0])
Batch 27: Data shape: torch.Size([12948, 1024]), Label: tensor([0])
Batch 28: Data shape: torch.Size([5085, 1024]), Label: tensor([0])
Batch 29: Data shape: torch.Size([23008, 1024]), Label: tensor([0])
Batch 30: Data shape: torch.Size([21381, 1024]), Label: tensor([0])
Batch 31: Data shape: torch.Size([8017, 1024]), Label: tensor([0])
Batch 32: Data shape: torch.Size([10028, 1024]), Label: tensor([0])
Batch 33: Data shape: torch.Size([15324, 1024]), Label: tensor([0])
Batch 34: Data shape: torch.Size([10246, 1024]), Label: tensor([0])
Batch 35: Data shape: torch.Size([12917, 1024]), Label: tensor([0])
Batch 36: Data shape: torch.Size([8223, 1024]), Label: tensor([0])
Batch 37: Data shape: torch.Size([1470, 1024]), Label: tensor([0])
Batch 38: Data shape: torch.Size([2553, 1024]), Label: tensor([0])
Batch 39: Data shape: torch.Size([16554, 1024]), Label: tensor([0])
Batch 40: Data shape: torch.Size([16995, 1024]), Label: tensor([0])
Batch 41: Data shape: torch.Size([2305, 1024]), Label: tensor([0])
Batch 42: Data shape: torch.Size([2039, 1024]), Label: tensor([0])
Batch 43: Data shape: torch.Size([16722, 1024]), Label: tensor([1])
Batch 44: Data shape: torch.Size([3919, 1024]), Label: tensor([1])
Batch 45: Data shape: torch.Size([20472, 1024]), Label: tensor([1])
Batch 46: Data shape: torch.Size([16528, 1024]), Label: tensor([1])
Batch 47: Data shape: torch.Size([14467, 1024]), Label: tensor([1])
Batch 48: Data shape: torch.Size([3921, 1024]), Label: tensor([0])
Batch 49: Data shape: torch.Size([1748, 1024]), Label: tensor([0])
Batch 50: Data shape: torch.Size([6906, 1024]), Label: tensor([0])
Batch 51: Data shape: torch.Size([12297, 1024]), Label: tensor([0])
Batch 52: Data shape: torch.Size([16294, 1024]), Label: tensor([0])
Batch 53: Data shape: torch.Size([11953, 1024]), Label: tensor([0])
Batch 54: Data shape: torch.Size([11234, 1024]), Label: tensor([0])
Batch 55: Data shape: torch.Size([13404, 1024]), Label: tensor([0])
Batch 56: Data shape: torch.Size([11913, 1024]), Label: tensor([0])
Batch 57: Data shape: torch.Size([2090, 1024]), Label: tensor([1])
Batch 58: Data shape: torch.Size([7963, 1024]), Label: tensor([1])
Batch 59: Data shape: torch.Size([3638, 1024]), Label: tensor([1])
Batch 60: Data shape: torch.Size([915, 1024]), Label: tensor([0])
Batch 61: Data shape: torch.Size([20033, 1024]), Label: tensor([0])
Batch 62: Data shape: torch.Size([7280, 1024]), Label: tensor([0])
Batch 63: Data shape: torch.Size([1956, 1024]), Label: tensor([0])
Batch 64: Data shape: torch.Size([2907, 1024]), Label: tensor([0])
Batch 65: Data shape: torch.Size([2520, 1024]), Label: tensor([0])
Batch 66: Data shape: torch.Size([13391, 1024]), Label: tensor([0])
Batch 67: Data shape: torch.Size([12846, 1024]), Label: tensor([0])
Batch 68: Data shape: torch.Size([4856, 1024]), Label: tensor([0])
Batch 69: Data shape: torch.Size([13751, 1024]), Label: tensor([0])
Batch 70: Data shape: torch.Size([10846, 1024]), Label: tensor([0])
Batch 71: Data shape: torch.Size([9719, 1024]), Label: tensor([0])
Batch 72: Data shape: torch.Size([10319, 1024]), Label: tensor([0])
Batch 73: Data shape: torch.Size([14899, 1024]), Label: tensor([0])
Batch 74: Data shape: torch.Size([8749, 1024]), Label: tensor([0])
Batch 75: Data shape: torch.Size([6232, 1024]), Label: tensor([0])
Batch 76: Data shape: torch.Size([13601, 1024]), Label: tensor([0])
Batch 77: Data shape: torch.Size([14913, 1024]), Label: tensor([0])
test_error:  0.11538461538461539
auc:  0.8875
f1 score:  0.8875939972004298
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 78
Loader contains 78 batches
Loader length after enter summary: 78
Loader length: 78
Batch 0: Data shape: torch.Size([6842, 1024]), Label: tensor([0])
Batch 1: Data shape: torch.Size([13717, 1024]), Label: tensor([0])
Batch 2: Data shape: torch.Size([22957, 1024]), Label: tensor([0])
Batch 3: Data shape: torch.Size([504, 1024]), Label: tensor([0])
Batch 4: Data shape: torch.Size([12414, 1024]), Label: tensor([0])
Batch 5: Data shape: torch.Size([3385, 1024]), Label: tensor([0])
Batch 6: Data shape: torch.Size([3244, 1024]), Label: tensor([0])
Batch 7: Data shape: torch.Size([28475, 1024]), Label: tensor([0])
Batch 8: Data shape: torch.Size([7531, 1024]), Label: tensor([0])
Batch 9: Data shape: torch.Size([683, 1024]), Label: tensor([0])
Batch 10: Data shape: torch.Size([27187, 1024]), Label: tensor([0])
Batch 11: Data shape: torch.Size([13966, 1024]), Label: tensor([0])
Batch 12: Data shape: torch.Size([13660, 1024]), Label: tensor([0])
Batch 13: Data shape: torch.Size([3155, 1024]), Label: tensor([0])
Batch 14: Data shape: torch.Size([4466, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([3556, 1024]), Label: tensor([0])
Batch 16: Data shape: torch.Size([4937, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([11830, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([22981, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([2345, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([7505, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([1748, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([6245, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([19868, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([7603, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([6098, 1024]), Label: tensor([0])
Batch 26: Data shape: torch.Size([14530, 1024]), Label: tensor([0])
Batch 27: Data shape: torch.Size([12948, 1024]), Label: tensor([0])
Batch 28: Data shape: torch.Size([5085, 1024]), Label: tensor([0])
Batch 29: Data shape: torch.Size([23008, 1024]), Label: tensor([0])
Batch 30: Data shape: torch.Size([21381, 1024]), Label: tensor([0])
Batch 31: Data shape: torch.Size([8017, 1024]), Label: tensor([0])
Batch 32: Data shape: torch.Size([10028, 1024]), Label: tensor([0])
Batch 33: Data shape: torch.Size([15324, 1024]), Label: tensor([0])
Batch 34: Data shape: torch.Size([10246, 1024]), Label: tensor([0])
Batch 35: Data shape: torch.Size([12917, 1024]), Label: tensor([0])
Batch 36: Data shape: torch.Size([8223, 1024]), Label: tensor([0])
Batch 37: Data shape: torch.Size([1470, 1024]), Label: tensor([0])
Batch 38: Data shape: torch.Size([2553, 1024]), Label: tensor([0])
Batch 39: Data shape: torch.Size([16554, 1024]), Label: tensor([0])
Batch 40: Data shape: torch.Size([16995, 1024]), Label: tensor([0])
Batch 41: Data shape: torch.Size([2305, 1024]), Label: tensor([0])
Batch 42: Data shape: torch.Size([2039, 1024]), Label: tensor([0])
Batch 43: Data shape: torch.Size([16722, 1024]), Label: tensor([1])
Batch 44: Data shape: torch.Size([3919, 1024]), Label: tensor([1])
Batch 45: Data shape: torch.Size([20472, 1024]), Label: tensor([1])
Batch 46: Data shape: torch.Size([16528, 1024]), Label: tensor([1])
Batch 47: Data shape: torch.Size([14467, 1024]), Label: tensor([1])
Batch 48: Data shape: torch.Size([3921, 1024]), Label: tensor([0])
Batch 49: Data shape: torch.Size([1748, 1024]), Label: tensor([0])
Batch 50: Data shape: torch.Size([6906, 1024]), Label: tensor([0])
Batch 51: Data shape: torch.Size([12297, 1024]), Label: tensor([0])
Batch 52: Data shape: torch.Size([16294, 1024]), Label: tensor([0])
Batch 53: Data shape: torch.Size([11953, 1024]), Label: tensor([0])
Batch 54: Data shape: torch.Size([11234, 1024]), Label: tensor([0])
Batch 55: Data shape: torch.Size([13404, 1024]), Label: tensor([0])
Batch 56: Data shape: torch.Size([11913, 1024]), Label: tensor([0])
Batch 57: Data shape: torch.Size([2090, 1024]), Label: tensor([1])
Batch 58: Data shape: torch.Size([7963, 1024]), Label: tensor([1])
Batch 59: Data shape: torch.Size([3638, 1024]), Label: tensor([1])
Batch 60: Data shape: torch.Size([915, 1024]), Label: tensor([0])
Batch 61: Data shape: torch.Size([20033, 1024]), Label: tensor([0])
Batch 62: Data shape: torch.Size([7280, 1024]), Label: tensor([0])
Batch 63: Data shape: torch.Size([1956, 1024]), Label: tensor([0])
Batch 64: Data shape: torch.Size([2907, 1024]), Label: tensor([0])
Batch 65: Data shape: torch.Size([2520, 1024]), Label: tensor([0])
Batch 66: Data shape: torch.Size([13391, 1024]), Label: tensor([0])
Batch 67: Data shape: torch.Size([12846, 1024]), Label: tensor([0])
Batch 68: Data shape: torch.Size([4856, 1024]), Label: tensor([0])
Batch 69: Data shape: torch.Size([13751, 1024]), Label: tensor([0])
Batch 70: Data shape: torch.Size([10846, 1024]), Label: tensor([0])
Batch 71: Data shape: torch.Size([9719, 1024]), Label: tensor([0])
Batch 72: Data shape: torch.Size([10319, 1024]), Label: tensor([0])
Batch 73: Data shape: torch.Size([14899, 1024]), Label: tensor([0])
Batch 74: Data shape: torch.Size([8749, 1024]), Label: tensor([0])
Batch 75: Data shape: torch.Size([6232, 1024]), Label: tensor([0])
Batch 76: Data shape: torch.Size([13601, 1024]), Label: tensor([0])
Batch 77: Data shape: torch.Size([14913, 1024]), Label: tensor([0])
test_error:  0.11538461538461539
auc:  0.8267857142857142
f1 score:  0.8725121032813342
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 78
Loader contains 78 batches
Loader length after enter summary: 78
Loader length: 78
Batch 0: Data shape: torch.Size([6842, 1024]), Label: tensor([0])
Batch 1: Data shape: torch.Size([13717, 1024]), Label: tensor([0])
Batch 2: Data shape: torch.Size([22957, 1024]), Label: tensor([0])
Batch 3: Data shape: torch.Size([504, 1024]), Label: tensor([0])
Batch 4: Data shape: torch.Size([12414, 1024]), Label: tensor([0])
Batch 5: Data shape: torch.Size([3385, 1024]), Label: tensor([0])
Batch 6: Data shape: torch.Size([3244, 1024]), Label: tensor([0])
Batch 7: Data shape: torch.Size([28475, 1024]), Label: tensor([0])
Batch 8: Data shape: torch.Size([7531, 1024]), Label: tensor([0])
Batch 9: Data shape: torch.Size([683, 1024]), Label: tensor([0])
Batch 10: Data shape: torch.Size([27187, 1024]), Label: tensor([0])
Batch 11: Data shape: torch.Size([13966, 1024]), Label: tensor([0])
Batch 12: Data shape: torch.Size([13660, 1024]), Label: tensor([0])
Batch 13: Data shape: torch.Size([3155, 1024]), Label: tensor([0])
Batch 14: Data shape: torch.Size([4466, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([3556, 1024]), Label: tensor([0])
Batch 16: Data shape: torch.Size([4937, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([11830, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([22981, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([2345, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([7505, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([1748, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([6245, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([19868, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([7603, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([6098, 1024]), Label: tensor([0])
Batch 26: Data shape: torch.Size([14530, 1024]), Label: tensor([0])
Batch 27: Data shape: torch.Size([12948, 1024]), Label: tensor([0])
Batch 28: Data shape: torch.Size([5085, 1024]), Label: tensor([0])
Batch 29: Data shape: torch.Size([23008, 1024]), Label: tensor([0])
Batch 30: Data shape: torch.Size([21381, 1024]), Label: tensor([0])
Batch 31: Data shape: torch.Size([8017, 1024]), Label: tensor([0])
Batch 32: Data shape: torch.Size([10028, 1024]), Label: tensor([0])
Batch 33: Data shape: torch.Size([15324, 1024]), Label: tensor([0])
Batch 34: Data shape: torch.Size([10246, 1024]), Label: tensor([0])
Batch 35: Data shape: torch.Size([12917, 1024]), Label: tensor([0])
Batch 36: Data shape: torch.Size([8223, 1024]), Label: tensor([0])
Batch 37: Data shape: torch.Size([1470, 1024]), Label: tensor([0])
Batch 38: Data shape: torch.Size([2553, 1024]), Label: tensor([0])
Batch 39: Data shape: torch.Size([16554, 1024]), Label: tensor([0])
Batch 40: Data shape: torch.Size([16995, 1024]), Label: tensor([0])
Batch 41: Data shape: torch.Size([2305, 1024]), Label: tensor([0])
Batch 42: Data shape: torch.Size([2039, 1024]), Label: tensor([0])
Batch 43: Data shape: torch.Size([16722, 1024]), Label: tensor([1])
Batch 44: Data shape: torch.Size([3919, 1024]), Label: tensor([1])
Batch 45: Data shape: torch.Size([20472, 1024]), Label: tensor([1])
Batch 46: Data shape: torch.Size([16528, 1024]), Label: tensor([1])
Batch 47: Data shape: torch.Size([14467, 1024]), Label: tensor([1])
Batch 48: Data shape: torch.Size([3921, 1024]), Label: tensor([0])
Batch 49: Data shape: torch.Size([1748, 1024]), Label: tensor([0])
Batch 50: Data shape: torch.Size([6906, 1024]), Label: tensor([0])
Batch 51: Data shape: torch.Size([12297, 1024]), Label: tensor([0])
Batch 52: Data shape: torch.Size([16294, 1024]), Label: tensor([0])
Batch 53: Data shape: torch.Size([11953, 1024]), Label: tensor([0])
Batch 54: Data shape: torch.Size([11234, 1024]), Label: tensor([0])
Batch 55: Data shape: torch.Size([13404, 1024]), Label: tensor([0])
Batch 56: Data shape: torch.Size([11913, 1024]), Label: tensor([0])
Batch 57: Data shape: torch.Size([2090, 1024]), Label: tensor([1])
Batch 58: Data shape: torch.Size([7963, 1024]), Label: tensor([1])
Batch 59: Data shape: torch.Size([3638, 1024]), Label: tensor([1])
Batch 60: Data shape: torch.Size([915, 1024]), Label: tensor([0])
Batch 61: Data shape: torch.Size([20033, 1024]), Label: tensor([0])
Batch 62: Data shape: torch.Size([7280, 1024]), Label: tensor([0])
Batch 63: Data shape: torch.Size([1956, 1024]), Label: tensor([0])
Batch 64: Data shape: torch.Size([2907, 1024]), Label: tensor([0])
Batch 65: Data shape: torch.Size([2520, 1024]), Label: tensor([0])
Batch 66: Data shape: torch.Size([13391, 1024]), Label: tensor([0])
Batch 67: Data shape: torch.Size([12846, 1024]), Label: tensor([0])
Batch 68: Data shape: torch.Size([4856, 1024]), Label: tensor([0])
Batch 69: Data shape: torch.Size([13751, 1024]), Label: tensor([0])
Batch 70: Data shape: torch.Size([10846, 1024]), Label: tensor([0])
Batch 71: Data shape: torch.Size([9719, 1024]), Label: tensor([0])
Batch 72: Data shape: torch.Size([10319, 1024]), Label: tensor([0])
Batch 73: Data shape: torch.Size([14899, 1024]), Label: tensor([0])
Batch 74: Data shape: torch.Size([8749, 1024]), Label: tensor([0])
Batch 75: Data shape: torch.Size([6232, 1024]), Label: tensor([0])
Batch 76: Data shape: torch.Size([13601, 1024]), Label: tensor([0])
Batch 77: Data shape: torch.Size([14913, 1024]), Label: tensor([0])
test_error:  0.1282051282051282
auc:  0.8446428571428573
f1 score:  0.8359676852827537
Ensemble Acc: 0.8974358974358975, AUC: 0.6107142857142857, F1: 0.3333333333333333
{'task': 'task_3_tgca', 'split': 'all', 'save_dir': '/g/data/au38/yy3740/results/EVAL_Florida_eval_run', 'models_dir': '/g/data/au38/yy3740/results/task_3_tgca_clam_sb_k3_lr1e-4/task_3_tgca_clam_sb_s1', 'model_type': 'clam_sb', 'drop_out': 0.25, 'model_size': 'small'}
Filtered dataset size: 26
label column: label
label dictionary: {0: 0, 1: 1}
number of classes: 2
slide-level counts:  
 label
1    15
0    11
Name: count, dtype: int64
Slide-LVL; Number of samples registered in class 0: 11
Slide-LVL; Number of samples registered in class 1: 15
Data directory: /g/data/au38/yy3740/Eval/Florida_feats/h5_files
Initializing dataset with 26 entries
Filtered initial_len=26
Filtered filtered_len=26
Filtered 0 entries without corresponding .h5 files.
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 26
Loader contains 26 batches
Loader length after enter summary: 26
Loader length: 26
Batch 0: Data shape: torch.Size([59487, 1024]), Label: tensor([1])
Batch 1: Data shape: torch.Size([43635, 1024]), Label: tensor([1])
Batch 2: Data shape: torch.Size([67814, 1024]), Label: tensor([1])
Batch 3: Data shape: torch.Size([50046, 1024]), Label: tensor([1])
Batch 4: Data shape: torch.Size([83068, 1024]), Label: tensor([1])
Batch 5: Data shape: torch.Size([54914, 1024]), Label: tensor([1])
Batch 6: Data shape: torch.Size([77857, 1024]), Label: tensor([1])
Batch 7: Data shape: torch.Size([56570, 1024]), Label: tensor([1])
Batch 8: Data shape: torch.Size([57824, 1024]), Label: tensor([1])
Batch 9: Data shape: torch.Size([64252, 1024]), Label: tensor([1])
Batch 10: Data shape: torch.Size([46433, 1024]), Label: tensor([1])
Batch 11: Data shape: torch.Size([45392, 1024]), Label: tensor([1])
Batch 12: Data shape: torch.Size([44802, 1024]), Label: tensor([1])
Batch 13: Data shape: torch.Size([66468, 1024]), Label: tensor([1])
Batch 14: Data shape: torch.Size([53807, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([69495, 1024]), Label: tensor([1])
Batch 16: Data shape: torch.Size([71473, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([57911, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([113453, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([45563, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([25064, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([53338, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([32916, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([73872, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([24024, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([43794, 1024]), Label: tensor([0])
test_error:  0.46153846153846156
auc:  0.7757575757575758
f1 score:  0.40384615384615385
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 26
Loader contains 26 batches
Loader length after enter summary: 26
Loader length: 26
Batch 0: Data shape: torch.Size([59487, 1024]), Label: tensor([1])
Batch 1: Data shape: torch.Size([43635, 1024]), Label: tensor([1])
Batch 2: Data shape: torch.Size([67814, 1024]), Label: tensor([1])
Batch 3: Data shape: torch.Size([50046, 1024]), Label: tensor([1])
Batch 4: Data shape: torch.Size([83068, 1024]), Label: tensor([1])
Batch 5: Data shape: torch.Size([54914, 1024]), Label: tensor([1])
Batch 6: Data shape: torch.Size([77857, 1024]), Label: tensor([1])
Batch 7: Data shape: torch.Size([56570, 1024]), Label: tensor([1])
Batch 8: Data shape: torch.Size([57824, 1024]), Label: tensor([1])
Batch 9: Data shape: torch.Size([64252, 1024]), Label: tensor([1])
Batch 10: Data shape: torch.Size([46433, 1024]), Label: tensor([1])
Batch 11: Data shape: torch.Size([45392, 1024]), Label: tensor([1])
Batch 12: Data shape: torch.Size([44802, 1024]), Label: tensor([1])
Batch 13: Data shape: torch.Size([66468, 1024]), Label: tensor([1])
Batch 14: Data shape: torch.Size([53807, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([69495, 1024]), Label: tensor([1])
Batch 16: Data shape: torch.Size([71473, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([57911, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([113453, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([45563, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([25064, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([53338, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([32916, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([73872, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([24024, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([43794, 1024]), Label: tensor([0])
test_error:  0.4230769230769231
auc:  0.6484848484848484
f1 score:  0.5636028139776266
Init Model
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=2, bias=True)
  (instance_classifiers): ModuleList(
    (0-1): 2 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): CrossEntropyLoss()
)
Total number of parameters: 790791
Total number of trainable parameters: 790791
Init Loaders
Dataset length: 26
Loader contains 26 batches
Loader length after enter summary: 26
Loader length: 26
Batch 0: Data shape: torch.Size([59487, 1024]), Label: tensor([1])
Batch 1: Data shape: torch.Size([43635, 1024]), Label: tensor([1])
Batch 2: Data shape: torch.Size([67814, 1024]), Label: tensor([1])
Batch 3: Data shape: torch.Size([50046, 1024]), Label: tensor([1])
Batch 4: Data shape: torch.Size([83068, 1024]), Label: tensor([1])
Batch 5: Data shape: torch.Size([54914, 1024]), Label: tensor([1])
Batch 6: Data shape: torch.Size([77857, 1024]), Label: tensor([1])
Batch 7: Data shape: torch.Size([56570, 1024]), Label: tensor([1])
Batch 8: Data shape: torch.Size([57824, 1024]), Label: tensor([1])
Batch 9: Data shape: torch.Size([64252, 1024]), Label: tensor([1])
Batch 10: Data shape: torch.Size([46433, 1024]), Label: tensor([1])
Batch 11: Data shape: torch.Size([45392, 1024]), Label: tensor([1])
Batch 12: Data shape: torch.Size([44802, 1024]), Label: tensor([1])
Batch 13: Data shape: torch.Size([66468, 1024]), Label: tensor([1])
Batch 14: Data shape: torch.Size([53807, 1024]), Label: tensor([0])
Batch 15: Data shape: torch.Size([69495, 1024]), Label: tensor([1])
Batch 16: Data shape: torch.Size([71473, 1024]), Label: tensor([0])
Batch 17: Data shape: torch.Size([57911, 1024]), Label: tensor([0])
Batch 18: Data shape: torch.Size([113453, 1024]), Label: tensor([0])
Batch 19: Data shape: torch.Size([45563, 1024]), Label: tensor([0])
Batch 20: Data shape: torch.Size([25064, 1024]), Label: tensor([0])
Batch 21: Data shape: torch.Size([53338, 1024]), Label: tensor([0])
Batch 22: Data shape: torch.Size([32916, 1024]), Label: tensor([0])
Batch 23: Data shape: torch.Size([73872, 1024]), Label: tensor([0])
Batch 24: Data shape: torch.Size([24024, 1024]), Label: tensor([0])
Batch 25: Data shape: torch.Size([43794, 1024]), Label: tensor([0])
test_error:  0.3076923076923077
auc:  0.7333333333333334
f1 score:  0.6762192056309703
Ensemble Acc: 0.4230769230769231, AUC: 0.3909090909090909, F1: 0.5454545454545454

======================================================================================
                  Resource Usage on 2024-10-14 19:12:21:
   Job Id:             126787068.gadi-pbs
   Project:            au38
   Exit Status:        0
   Service Units:      3.78
   NCPUs Requested:    12                     NCPUs Used: 12              
                                           CPU Time Used: 00:03:24        
   Memory Requested:   64.0GB                Memory Used: 22.2GB          
   NGPUs Requested:    1                 GPU Utilisation: 5%              
                                         GPU Memory Used: 2.05GB          
   Walltime requested: 12:00:00            Walltime Used: 00:06:18        
   JobFS requested:    100.0MB                JobFS used: 0B              
======================================================================================
